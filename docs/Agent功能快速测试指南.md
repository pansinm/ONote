# Agent 功能快速测试指南

## 准备工作

### 1. 启动应用
```bash
yarn dev
```

### 2. 验证构建
确保所有包成功编译：
```bash
yarn build
```

## 功能测试

### 测试 1: 工具列表显示

**步骤:**
1. 启动应用
2. 在侧边栏打开 LLMBox
3. 切换到 Agent 模式（点击 "🤖 Agent" 按钮）

**预期结果:**
- ✅ 看到 "Available Tools" 区域
- ✅ 显示 7 个工具：
  - 📄 readFile
  - ✏️  writeFile
  - 🆕 createFile
  - 🗑️  deleteFile
  - 📂 listFiles
  - 🔍 searchFiles
  - 🔎 searchInFile
- ✅ 工具卡片有漂亮的渐变背景
- ✅ 工具有 read/write 权限标签
- ✅ 危险工具（write、delete）有 ⚠️ 标记
- ✅ 滚动条美观且平滑

### 测试 2: 简单工具调用

**步骤:**
1. 在输入框输入：`读取当前文件的内容`
2. 点击 "🚀 Run Agent" 按钮

**预期结果:**
- ✅ 状态变为 "executing"
- ✅ 执行日志显示：
  ```
  1. [thinking] 我需要先读取文件...
  2. [tool_call] readFile(uri='...')
  3. [tool_result] 返回文件内容
  4. [final_answer] 文件内容已读取...
  ```
- ✅ 工具调用详情可以展开查看参数和结果
- ✅ 显示执行时间
- ✅ 状态自动返回到 "idle"

### 测试 3: 多轮迭代

**步骤:**
1. 输入：`在 /docs 目录下查找所有 Markdown 文件`
2. 点击 "🚀 Run Agent"

**预期结果:**
- ✅ Agent 先调用 `listFiles` 工具
- ✅ 然后根据结果继续思考
- ✅ 可能调用其他工具（如 `searchFiles`）
- ✅ 显示完整的思考过程
- ✅ 执行步骤实时添加

### 测试 4: 错误处理

**步骤:**
1. 输入：`读取 /不存在的文件路径/file.md`
2. 点击 "🚀 Run Agent"

**预期结果:**
- ✅ 工具调用失败
- ✅ 显示红色错误步骤
- ✅ 错误信息清晰
- ✅ 状态变为 "idle"
- ✅ 不会影响后续操作

### 测试 5: 停止功能

**步骤:**
1. 输入一个复杂任务（如批量修改文件）
2. 等待 Agent 开始执行
3. 点击 "⏹️ Stop" 按钮

**预期结果:**
- ✅ Agent 立即停止
- ✅ 执行日志显示 "Agent stopped by user"
- ✅ 状态变为 "idle"
- ✅ 可以开始新的任务

### 测试 6: 清除日志

**步骤:**
1. 运行一些任务，积累执行日志
2. 点击 "Execution Log" 区域的 "Clear" 按钮

**预期结果:**
- ✅ 执行日志清空
- ✅ 显示 "No execution history" 提示
- ✅ 工具列表保持不变

### 测试 7: 模式切换

**步骤:**
1. 在 Agent 模式下执行一些任务
2. 切换到 Chat 模式（点击 "💬 Chat" 按钮）
3. 输入一些消息
4. 切换回 Agent 模式

**预期结果:**
- ✅ 两种模式独立运行
- ✅ Chat 模式显示消息历史
- ✅ Agent 模式显示工具和执行日志
- ✅ 状态正确保持

## 样式测试

### 测试 8: 滚动条样式

**步骤:**
1. 添加大量执行步骤（超过 10 个）
2. 在工具列表区域滚动
3. 在执行日志区域滚动
4. 在代码块区域滚动

**预期结果:**
- ✅ 滚动条宽度约 8px
- ✅ 滚动条有圆角
- ✅ 滚动条背景为浅灰色
- ✅ 滚动条（thumb）有悬停效果
- ✅ 滚动平滑流畅

### 测试 9: 悬停效果

**步骤:**
1. 鼠标悬停在工具卡片上
2. 鼠标悬停在执行步骤上
3. 鼠标悬停在按钮上

**预期结果:**
- ✅ 工具卡片显示阴影和轻微上移
- ✅ 顶部彩色线条展开
- ✅ 执行步骤显示增强阴影
- ✅ 按钮颜色和阴影变化

### 测试 10: 动画效果

**步骤:**
1. 观察新步骤添加时的动画
2. 观察状态指示器动画
3. 观察危险工具标记

**预期结果:**
- ✅ 新步骤从上方滑入（slideIn 动画）
- ✅ 状态点有脉冲动画（thinking/executing）
- ✅ 错误步骤有脉冲阴影动画
- ✅ 危险工具有抖动动画（shake）

### 测试 11: 响应式布局

**步骤:**
1. 调整浏览器窗口宽度到 768px 以下
2. 检查工具网格和执行步骤

**预期结果:**
- ✅ 工具网格调整列数
- ✅ 工具卡片间距减小
- ✅ 执行步骤内边距减小
- ✅ 布局保持整洁

### 测试 12: 深色模式（可选）

**步骤:**
1. 在系统设置中启用深色模式
2. 检查所有界面元素

**预期结果:**
- ✅ 背景变为深色
- ✅ 文本颜色自动调整
- ✅ 边框和阴影适配
- ✅ 渐变和动画保持一致

## 性能测试

### 测试 13: 大量执行步骤

**步骤:**
1. 运行一个需要多次迭代的长任务
2. 观察页面性能

**预期结果:**
- ✅ 页面滚动流畅
- ✅ 没有明显卡顿
- ✅ 动画保持 60fps
- ✅ 内存使用合理

### 测试 14: 快速模式切换

**步骤:**
1. 快速点击 Chat/Agent 模式切换按钮（10 次以上）
2. 观察性能和状态

**预期结果:**
- ✅ 模式切换即时响应
- ✅ 没有状态混乱
- ✅ 动画流畅

## 集成测试

### 测试 15: 端到端流程

**步骤:**
1. 在主窗口打开一个文件
2. 切换到 Agent 模式
3. 输入：`总结这个文件的内容`
4. 等待 Agent 完成任务

**预期结果:**
- ✅ Agent 正确获取文件信息
- ✅ 通过 bidc 与主窗口通信
- ✅ 文件内容正确读取
- ✅ 总结结果准确

### 测试 16: 文件操作权限

**步骤:**
1. 尝试读取一个文件（应该成功）
2. 尝试写入一个文件（应该需要确认）
3. 尝试删除一个文件（应该需要确认）

**预期结果:**
- ✅ 读取操作无需确认即可执行
- ✅ 写入操作应该有确认提示（如果实现）
- ✅ 删除操作应该有明确警告（如果实现）

## 浏览器兼容性

### Chrome/Edge

测试环境：
- Chrome 最新版
- Edge 最新版

检查项：
- ✅ 所有样式正常显示
- ✅ 滚动条自定义有效
- ✅ 动画流畅
- ✅ 无控制台错误

### Firefox

测试环境：
- Firefox 最新版

检查项：
- ✅ 样式基本正常
- ✅ 滚动条自定义有效
- ⚠️ 可能需要调整 `-moz-` 前缀
- ✅ 动画流畅

### Safari

测试环境：
- Safari macOS
- Safari iOS

检查项：
- ✅ 样式正常显示
- ✅ 滚动条样式正常
- ✅ 平滑滚动有效
- ⚠️ 可能有细微差异

## 常见问题排查

### 问题 1: Agent 不执行

**可能原因:**
- API Key 未配置
- 网络连接问题
- LLM API 错误

**解决方法:**
1. 检查设置中的 API Key
2. 打开浏览器控制台查看错误
3. 检查网络连接

### 问题 2: 工具调用失败

**可能原因:**
- 文件路径格式错误
- 文件不存在
- 权限不足

**解决方法:**
1. 检查文件路径格式（`file:///` 开头）
2. 确认文件存在
3. 查看执行日志中的错误信息

### 问题 3: 样式显示异常

**可能原因:**
- CSS 文件未正确加载
- 浏览器缓存
- 构建问题

**解决方法:**
1. 清除浏览器缓存并刷新
2. 重新构建项目（`yarn build`）
3. 检查 CSS 文件是否存在

### 问题 4: 滚动条不生效

**可能原因:**
- 内容高度未超过容器
- CSS 权重问题
- 浏览器不兼容

**解决方法:**
1. 添加更多执行步骤触发滚动
2. 增加 CSS 选择器权重
3. 检查浏览器兼容性

## 性能指标

### 目标性能

- ⚡ **首次渲染**: < 100ms
- ⚡ **模式切换**: < 50ms
- ⚡ **步骤添加**: < 100ms
- ⚡ **滚动 FPS**: ≥ 55fps
- ⚡ **动画 FPS**: 60fps

### 性能监控

打开浏览器开发者工具：
1. Performance 标签
2. 录制性能
3. 运行 Agent 任务
4. 分析结果

## 测试报告模板

```
测试日期: ___________
测试者: ___________
浏览器: ___________
操作系统: ___________

功能测试:
[ ] 工具列表显示
[ ] 简单工具调用
[ ] 多轮迭代
[ ] 错误处理
[ ] 停止功能
[ ] 清除日志
[ ] 模式切换

样式测试:
[ ] 滚动条样式
[ ] 悬停效果
[ ] 动画效果
[ ] 响应式布局
[ ] 深色模式

性能测试:
[ ] 页面流畅性
[ ] 模式切换速度
[ ] 动画流畅度

整体评价:
功能完成度: __/10
样式满意度: __/10
性能满意度: __/10

备注:
```

## 下一步

测试完成后：

1. **记录问题** - 记录所有发现的问题
2. **优先级排序** - 标注问题的严重程度
3. **创建 issue** - 在 GitHub 上提交 issue
4. **计划修复** - 根据优先级安排修复

## 总结

通过以上测试，确保：

✅ **所有核心功能正常工作**
✅ **UI/UX 达到设计目标**
✅ **性能符合预期**
✅ **浏览器兼容性良好**
✅ **可以发布到用户**

祝你测试顺利！🎉

---

**文档版本**: 1.0
**创建日期**: 2026-01-06
**最后更新**: 2026-01-06
